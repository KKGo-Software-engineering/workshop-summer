apiVersion: apps/v1
kind: Deployment
metadata:
  name: <GROUP_NO>-prod-deployment
  namespace: <GROUP_NO>-prod
spec:
  selector:
    matchLabels:
      app: api
  replicas: 1
  template:
    metadata:
      labels:
        app: api
    spec:
      containers:
        - name: workshop-summer-<GROUP_NO>
          image: ghcr.io/kkgo-software-engineering/workshop-summer-<GROUP_NO>:b363bea56839ebd2adf0f1bae2a36726e25ff810
          imagePullPolicy: Always
          env:
              -   name: DATABASE_POSTGRES_URI
                  valueFrom:
                      configMapKeyRef:
                          name: app-config
                          key: db.url
          livenessProbe:
              httpGet:
                  path: /api/v1/health
                  port: 8080
              initialDelaySeconds: 5
              periodSeconds: 5
          readinessProbe:
              httpGet:
                  path: /api/v1/health
                  port: 8080
              initialDelaySeconds: 5
              periodSeconds: 5
          ports:
            - containerPort: 8080
          resources:
            limits:
              cpu: "0.5"
              memory: 256Mi
